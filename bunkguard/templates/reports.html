{% extends "base.html" %}
{% block title %}Reports - BunkGuard{% endblock %}
{% block head_scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-text">
        <h1>Attendance Reports</h1>
        <p>Visualize your academic trends and performance.</p>
    </div>
</div>

<div class="bento-grid-reports">

    <div class="bento-box kpi" id="bestSubjectBox">
        <div class="kpi-label"><i class='bx bxs-trophy'></i> Best Subject</div>
        <div class="kpi-value" id="bestSubjectName">--</div>
        <div class="kpi-sub" id="bestSubjectPercent">--%</div>
    </div>
    <div class="bento-box kpi" id="worstSubjectBox">
        <div class="kpi-label"><i class='bx bxs-down-arrow-circle'></i> Worst Subject</div>
        <div class="kpi-value" id="worstSubjectName">--</div>
        <div class="kpi-sub" id="worstSubjectPercent">--%</div>
    </div>
    <div class="bento-box kpi" id="streakBox">
        <div class="kpi-label"><i class='bx bxs-calendar-check'></i> Perfect Streak</div>
        <div class="kpi-value" id="attendanceStreak">--</div>
        <div class="kpi-sub">Consecutive days</div>
    </div>
    <div class="bento-box kpi" id="absencesBox">
        <div class="kpi-label"><i class='bx bxs-user-x'></i> Total Absences</div>
        <div class="kpi-value" id="totalAbsences">--</div>
        <div class="kpi-sub">This semester</div>
    </div>

    <div class="bento-box chart-main">
        <div class="widget-header">
            <h3><i class='bx bx-calendar-week'></i> Attendance by Day of Week</h3>
        </div>
        <div style="height:300px;"><canvas id="dayOfWeekChart"></canvas></div>
    </div>

    <div class="bento-box subject-breakdown">
        <div class="widget-header">
            <h3><i class='bx bxs-graduation'></i> Subject Breakdown (Semester <span id="currentSemesterLabel"></span>)
            </h3>
        </div>
        <div id="subjectBreakdownList">
        </div>
    </div>

    <div class="bento-box calendar-heatmap">
        <div class="widget-header">
            <h3><i class='bx bxs-grid'></i> Attendance Heatmap</h3>
        </div>
        <div id="heatmapContainer">
        </div>
    </div>

    <div class="bento-box full-log">
        <div class="widget-header">
            <h3><i class='bx bx-list-ul'></i> Full Attendance Log</h3>
        </div>
        <div id="fullAttendanceLogList">
        </div>
        <button id="loadMoreLogsBtn" class="create-new-btn"
            style="width: 100%; justify-content: center; margin-top: 20px; display: none;">Load More</button>
    </div>
</div>

{% endblock %}
{% block body_scripts %}
<script src="{{ url_for('static', filename='reports.js') }}"></script>{% endblock %}